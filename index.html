<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Legion Live</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="theme-color" content="#8b0000" />
<meta name="description" content="Legion Live – 21+ live streaming platform" />

<!-- PWA basics -->
<link rel="manifest" href="data:application/json,{
  &quot;name&quot;:&quot;Legion Live&quot;,
  &quot;short_name&quot;:&quot;Legion&quot;,
  &quot;start_url&quot;:&quot;.&quot;,
  &quot;display&quot;:&quot;standalone&quot;,
  &quot;background_color&quot;:&quot;#000000&quot;,
  &quot;theme_color&quot;:&quot;#8b0000&quot;
}" />

<style>
/* ===============================
   GLOBAL STYLES
=============================== */
* { box-sizing: border-box; }

:root {
  --bg: #000;
  --panel: #111;
  --border: #8b0000;
  --text: #e5e5e5;
  --accent: #c00000;
  --muted: #777;
}

body {
  margin: 0;
  background: var(--bg);
  color: var(--text);
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
}

header {
  padding: 14px;
  text-align: center;
  font-size: 1.6rem;
  font-weight: bold;
  border-bottom: 2px solid var(--border);
  background: #050505;
}

nav {
  display: flex;
  justify-content: center;
  gap: 10px;
  padding: 10px;
  border-bottom: 1px solid #300;
  background: #0a0a0a;
  position: sticky;
  top: 0;
  z-index: 10;
}

nav button {
  background: #000;
  color: var(--text);
  border: 1px solid var(--border);
  padding: 6px 12px;
  border-radius: 8px;
  cursor: pointer;
}

nav button:hover {
  background: var(--border);
}

main {
  max-width: 1100px;
  margin: auto;
  padding: 16px;
}

/* ===============================
   CARDS & UI
=============================== */
.card {
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 14px;
  padding: 16px;
  margin-bottom: 16px;
}

h2 {
  margin-top: 0;
}

input, textarea {
  width: 100%;
  background: #000;
  border: 1px solid var(--border);
  color: var(--text);
  padding: 8px;
  border-radius: 8px;
  margin-bottom: 10px;
}

button.primary {
  background: var(--border);
  border: none;
  padding: 10px;
  color: #fff;
  border-radius: 8px;
  cursor: pointer;
}

button.primary:hover {
  background: var(--accent);
}

.small {
  font-size: 0.85rem;
  color: var(--muted);
}

/* ===============================
   STREAM UI
=============================== */
video {
  width: 100%;
  border-radius: 12px;
  border: 1px solid var(--border);
  background: #000;
}

.stream-controls {
  display: flex;
  gap: 10px;
  margin-top: 10px;
}

/* ===============================
   ADMIN / WARNINGS
=============================== */
.warning {
  background: #300;
  border: 1px solid red;
  padding: 10px;
  border-radius: 10px;
  color: #ffaaaa;
}
</style>
</head>

<body>

<header>Legion Live</header>

<nav>
  <button onclick="route('home')">Home</button>
  <button onclick="route('login')">Login</button>
  <button onclick="route('profile')">Profile</button>
  <button onclick="route('stream')">Go Live</button>
  <button onclick="route('wallet')">Wallet</button>
</nav>

<main id="app"></main>

<script>
/* ===============================
   BASIC ROUTER
=============================== */
const app = document.getElementById("app");

function route(page) {
  if (page === "home") renderHome();
  if (page === "login") renderLogin();
  if (page === "profile") renderProfile();
  if (page === "stream") renderStream();
  if (page === "wallet") renderWallet();
}

/* ===============================
   APP STATE (CLIENT SIDE ONLY)
=============================== */
const state = {
  user: JSON.parse(localStorage.getItem("legion_user")) || null,
  ageVerified: localStorage.getItem("age_verified") === "yes"
};

function saveUser() {
  localStorage.setItem("legion_user", JSON.stringify(state.user));
}

/* ===============================
   SCREENS
=============================== */

function renderHome() {
  app.innerHTML = `
    <div class="card">
      <h2>Welcome to Legion Live</h2>
      <p class="small">
        Legion Live is a 21+ live streaming platform with strict moderation.
        No nudity. No drugs. Zero tolerance for minors on stream.
      </p>
      ${!state.ageVerified ? `
        <div class="warning">
          <strong>Age Verification Required</strong><br>
          You must confirm you are 21+ to proceed.
          <button class="primary" onclick="verifyAge()">I am 21+</button>
        </div>
      ` : `<p class="small">Age verified ✔</p>`}
    </div>
  `;
}

function verifyAge() {
  localStorage.setItem("age_verified", "yes");
  state.ageVerified = true;
  renderHome();
}

function renderLogin() {
  app.innerHTML = `
    <div class="card">
      <h2>Login / Register</h2>
      <input placeholder="Email" id="email" />
      <input placeholder="Password" type="password" id="password" />
      <button class="primary" onclick="login()">Continue</button>
    </div>
  `;
}

function login() {
  // TEMP: frontend-only placeholder
  state.user = {
    email: document.getElementById("email").value,
    name: "New User"
  };
  saveUser();
  route("profile");
}

function renderProfile() {
  if (!state.user) return route("login");
  app.innerHTML = `
    <div class="card">
      <h2>Profile</h2>
      <input value="${state.user.name}" onchange="updateName(this.value)" />
      <textarea placeholder="About me"></textarea>
      <p class="small">Creator payouts, verification, and moderation are enforced server-side.</p>
    </div>
  `;
}

function updateName(v) {
  state.user.name = v;
  saveUser();
}

function renderStream() {
  if (!state.ageVerified) return route("home");

  app.innerHTML = `
    <div class="card">
      <h2>Go Live</h2>
      <video id="video" autoplay muted></video>
      <div class="stream-controls">
        <button class="primary" onclick="startStream()">Start Camera</button>
        <button onclick="stopStream()">Stop</button>
      </div>
      <p class="small">Live moderation is enforced. Streams may be terminated automatically.</p>
    </div>
  `;
}

let mediaStream = null;

async function startStream() {
  mediaStream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
  document.getElementById("video").srcObject = mediaStream;
}

function stopStream() {
  if (!mediaStream) return;
  mediaStream.getTracks().forEach(t => t.stop());
}

function renderWallet() {
  app.innerHTML = `
    <div class="card">
      <h2>Wallet</h2>
      <p>Coins: <strong>0</strong></p>
      <button class="primary">Buy Coins</button>
      <p class="small">Payments and cash-out handled securely via backend.</p>
    </div>
  `;
}

/* ===============================
   INITIAL LOAD
=============================== */
route("home");
</script>

</body>
</html>
