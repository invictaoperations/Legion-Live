<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Legion Live</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<style>
/* ===============================
   GLOBAL THEME
   =============================== */

:root {
  --bg-main: #0b0d10;
  --bg-panel: #12151b;
  --bg-panel-soft: #161a21;
  --border-muted: #2a2f3a;
  --accent-bronze: #b08d57;
  --accent-bronze-soft: #7d6642;
  --text-main: #e6e6e6;
  --text-muted: #9aa0ab;
  --danger: #8b1e1e;
}

* {
  box-sizing: border-box;
}

body {
  margin: 0;
  background: radial-gradient(1200px at top, #141821, #07080b);
  color: var(--text-main);
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
}

/* ===============================
   HEADER
   =============================== */

header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 18px 28px;
  border-bottom: 1px solid var(--border-muted);
  background: linear-gradient(to bottom, #0e1118, #0a0c11);
}

header h1 {
  margin: 0;
  font-size: 20px;
  letter-spacing: 3px;
  font-weight: 700;
}

header span {
  color: var(--accent-bronze);
  font-weight: 600;
}

/* ===============================
   LAYOUT
   =============================== */

main {
  display: flex;
  max-width: 1200px;
  margin: 0 auto;
  padding: 24px;
  gap: 24px;
}

aside {
  width: 260px;
  background: var(--bg-panel);
  border: 1px solid var(--border-muted);
  padding: 16px;
}

section {
  flex: 1;
  background: var(--bg-panel);
  border: 1px solid var(--border-muted);
  padding: 24px;
}

/* ===============================
   NAV
   =============================== */

.nav-btn {
  display: block;
  width: 100%;
  padding: 12px 14px;
  margin-bottom: 8px;
  background: none;
  border: 1px solid transparent;
  color: var(--text-muted);
  text-align: left;
  cursor: pointer;
  font-size: 14px;
}

.nav-btn.active {
  background: var(--bg-panel-soft);
  border-color: var(--accent-bronze-soft);
  color: var(--text-main);
}

.nav-btn:hover {
  color: var(--text-main);
}

/* ===============================
   PROFILE PANEL
   =============================== */

h2 {
  margin-top: 0;
  margin-bottom: 16px;
  font-size: 18px;
  font-weight: 600;
}

.divider {
  height: 1px;
  background: linear-gradient(
    to right,
    transparent,
    var(--accent-bronze-soft),
    transparent
  );
  margin: 16px 0;
}

label {
  display: block;
  margin-top: 16px;
  margin-bottom: 6px;
  font-size: 13px;
  color: var(--text-muted);
}

input,
textarea {
  width: 100%;
  padding: 10px;
  background: #0b0e14;
  border: 1px solid var(--border-muted);
  color: var(--text-main);
  resize: vertical;
}

textarea {
  min-height: 90px;
}

button.primary {
  margin-top: 20px;
  width: 100%;
  padding: 12px;
  background: linear-gradient(to bottom, #b08d57, #8a6b3f);
  border: none;
  color: #000;
  font-weight: 600;
  cursor: pointer;
}

button.primary:hover {
  filter: brightness(1.05);
}

.status {
  margin-top: 12px;
  font-size: 13px;
}

/* ===============================
   RANK BADGE
   =============================== */

.rank-badge {
  display: inline-block;
  padding: 6px 10px;
  border: 1px solid var(--accent-bronze-soft);
  color: var(--accent-bronze);
  font-size: 12px;
  margin-top: 8px;
}

/* ===============================
   FOOTER
   =============================== */

footer {
  text-align: center;
  padding: 18px;
  color: var(--text-muted);
  font-size: 12px;
  border-top: 1px solid var(--border-muted);
}

/* ===============================
   RESPONSIVE
   =============================== */

@media (max-width: 900px) {
  main {
    flex-direction: column;
  }

  aside {
    width: 100%;
  }
}
</style>
</head>

<body>

<header>
  <h1>LEGION <span>LIVE</span></h1>
  <div class="rank-badge">LEGIONNAIRE</div>
</header>

<main>

  <aside>
    <button class="nav-btn active">Profile</button>
    <button class="nav-btn" disabled>Go Live (Soon)</button>
    <button class="nav-btn" disabled>Feed (Soon)</button>
    <button class="nav-btn" disabled>Tribunal (Admin)</button>
  </aside>

  <section>
    <h2>Legion Record</h2>
    <p style="color:var(--text-muted);font-size:14px;">
      Your public record within the Legion.
    </p>

    <div class="divider"></div>

    <label>Username</label>
    <input id="username" placeholder="legionnaire_name" />

    <label>About You</label>
    <textarea id="about" placeholder="Background, oath, or public description"></textarea>

    <button class="primary" onclick="saveProfile()">Save Record</button>

    <div id="status" class="status"></div>
  </section>

</main>

<footer>
  Legion Live · North America · Europe · Japan
</footer>

<script>
const API = "https://legion-live-backend-1.onrender.com";

async function saveProfile() {
  const username = document.getElementById("username").value.trim();
  const about = document.getElementById("about").value.trim();
  const status = document.getElementById("status");

  if (!username) {
    status.style.color = "#c33";
    status.textContent = "Username is required.";
    return;
  }

  try {
    await fetch(`${API}/auth/login`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ username })
    });

    await fetch(`${API}/me`, {
      method: "PUT",
      headers: {
        "Content-Type": "application/json",
        "Authorization": username
      },
      body: JSON.stringify({ about_me: about })
    });

    localStorage.setItem("legion_user", username);

    status.style.color = "#4caf50";
    status.textContent = "Profile saved.";
  } catch (err) {
    status.style.color = "#c33";
    status.textContent = "Error saving profile.";
  }
}

async function loadProfile() {
  const username = localStorage.getItem("legion_user");
  if (!username) return;

  document.getElementById("username").value = username;

  try {
    const res = await fetch(`${API}/me`, {
      headers: { "Authorization": username }
    });

    if (!res.ok) return;
    const data = await res.json();
    document.getElementById("about").value = data.about_me || "";
  } catch {}
}

loadProfile();
</script>

</body>
</html>
